"use strict";(globalThis["webpackChunkchinese_sub_finder_panel"]=globalThis["webpackChunkchinese_sub_finder_panel"]||[]).push([[230],{8856:(e,t,a)=>{a.r(t),a.d(t,{default:()=>X});a(3610);var i=a(3673),l=a(1959),s=a(4739),n=a(7771),o=a(6960),d=a(8880),_=a(2323),r=a(7493),p=a(9897),u=a(1315),c=a(8825),h=a(8534),m=a(2798),v=a(9608),f=a(3718),w=a(9238);const g={class:"area-cover q-mb-sm relative-position"},y=["title"],b={class:"row items-center"},S=["href"],q={__name:"ListItemMovie",props:{data:Object,width:{type:String,default:"160px"},coverHeight:{type:String,default:"200px"}},setup(e){const t=e;(0,d.sj)((t=>({"06da32de":e.width})));const a=(0,c.Z)(),n=(0,l.iH)(null),o=(0,l.iH)(null),q=async()=>{const[e]=await r.Z.getMoviePoster({name:t.data.name,main_root_dir_f_path:t.data.main_root_dir_f_path,video_f_path:t.data.video_f_path});n.value=e},Z=async()=>{const[e]=await r.Z.getMovieDetail({name:t.data.name,main_root_dir_f_path:t.data.main_root_dir_f_path,video_f_path:t.data.video_f_path});o.value=e},k=(0,i.Fl)((()=>o.value?.sub_url_list.length>0)),U=async()=>{a.dialog({title:"添加到下载队列",message:"选择下载任务的类型：",options:{model:3,type:"radio",items:[{label:"插队任务",value:3},{label:"一次性任务（执行成功后忽略该任务）",value:0}]},cancel:!0,persistent:!0}).onOk((async e=>{const[,a]=await r.Z.downloadSubtitle({video_type:u.b2,physical_video_file_full_path:t.data.video_f_path,task_priority_level:e,media_server_inside_video_id:t.data.media_server_inside_video_id});null!==a?p.j.error(a.message):p.j.success("已加入下载队列")}))};return(0,i.YP)(s.FC,((e,a)=>{(e.find((e=>e.video_f_path===t.data.video_f_path))&&!a.find((e=>e.video_f_path===t.data.video_f_path))||!e.find((e=>e.video_f_path===t.data.video_f_path))&&a.find((e=>e.video_f_path===t.data.video_f_path)))&&Z()})),(0,i.bv)((()=>{q(),Z()})),(a,r)=>{const p=(0,i.up)("q-img"),c=(0,i.up)("q-item-section"),q=(0,i.up)("q-btn"),Z=(0,i.up)("q-item"),W=(0,i.up)("q-list"),j=(0,i.up)("q-popup-proxy"),x=(0,i.up)("q-space"),Q=(0,i.up)("q-card");return(0,i.wg)(),(0,i.j4)(Q,{flat:"",square:""},{default:(0,i.w5)((()=>[(0,i._)("div",g,[n.value?.url?((0,i.wg)(),(0,i.j4)(p,{key:1,src:(0,l.SU)(s.Gr)(n.value.url),class:"content-width bg-grey-2","no-spinner":"",style:(0,_.j5)({width:e.width,height:e.coverHeight}),fit:"cover"},null,8,["src","style"])):((0,i.wg)(),(0,i.iD)("div",{key:0,style:(0,_.j5)({width:e.width,height:e.coverHeight})},null,4))]),(0,i._)("div",{class:"content-width text-ellipsis-line-2",title:e.data.name},(0,_.zw)(e.data.name),9,y),(0,i._)("div",b,[(0,l.SU)(k)?((0,i.wg)(),(0,i.j4)((0,l.SU)(v.Z),{key:0,size:"sm","subtitle-url-list":o.value?.sub_url_list,path:e.data.video_f_path},null,8,["subtitle-url-list","path"])):(0,i.kq)("",!0),(0,i._)("div",null,[(0,l.SU)(k)?((0,i.wg)(),(0,i.j4)(q,{key:0,size:"sm",color:"black",round:"",flat:"",dense:"",icon:"closed_caption",onClick:r[0]||(r[0]=(0,d.iM)((()=>{}),["stop"])),title:"已有字幕"},{default:(0,i.w5)((()=>[(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[(0,i.Wm)(W,{dense:""},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.value.sub_url_list,((e,t)=>((0,i.wg)(),(0,i.j4)(Z,{key:e},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{side:""},{default:(0,i.w5)((()=>[(0,i.Uk)((0,_.zw)(t+1)+".",1)])),_:2},1024),(0,i.Wm)(c,{class:"overflow-hidden ellipsis",title:e.split`(/\/|\\/)`.pop()},{default:(0,i.w5)((()=>[(0,i._)("a",{class:"text-primary",href:(0,l.SU)(s.Gr)(e),target:"_blank"},(0,_.zw)(e.split(/\/|\\/).pop()),9,S)])),_:2},1032,["title"]),(0,i.Wm)(c,{side:""},{default:(0,i.w5)((()=>[(0,i.Wm)(q,{color:"primary",round:"",flat:"",dense:"",icon:"construction",title:"字幕时间轴校准"+((0,l.SU)(w.OP).advanced_settings.fix_time_line?"":"（此功能需要在进阶设置里开启自动校正字幕时间轴，检测到你当前尚未开启此选项）"),onClick:t=>(0,l.SU)(s.qb)(e),disable:!(0,l.SU)(w.OP).advanced_settings.fix_time_line},null,8,["title","onClick","disable"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})):((0,i.wg)(),(0,i.j4)(q,{key:1,color:"grey",size:"sm",round:"",flat:"",dense:"",icon:"closed_caption",onClick:r[1]||(r[1]=(0,d.iM)((()=>{}),["stop"])),title:"没有字幕"}))]),(0,i.Wm)((0,l.SU)(f.Z),{path:t.data.video_f_path,"is-movie":""},null,8,["path"]),(0,i.Wm)(x),(0,i.Wm)((0,l.SU)(m.Z),{path:e.data.video_f_path,dense:"",size:"sm"},null,8,["path"]),(0,i.Wm)(q,{class:"btn-download",color:"primary",round:"",flat:"",dense:"",icon:"download_for_offline",title:"添加到下载队列",onClick:U,size:"sm"}),(0,i._)("div",null,[(0,i.Wm)((0,l.SU)(h.Z),{path:t.data.video_f_path,"video-type":(0,l.SU)(u.b2),size:"sm"},null,8,["path","video-type"])])])])),_:1})}}};var Z=a(4260),k=a(151),U=a(4027),W=a(2165),j=a(3944),x=a(7011),Q=a(3414),C=a(2035),z=a(2025),I=a(7518),H=a.n(I);const P=(0,Z.Z)(q,[["__scopeId","data-v-66f99fb4"]]),D=P;H()(q,"components",{QCard:k.Z,QImg:U.Z,QBtn:W.Z,QPopupProxy:j.Z,QList:x.Z,QItem:Q.Z,QItemSection:C.Z,QSpace:z.Z});const M={class:"row q-gutter-md"},L={key:0,class:"row q-gutter-x-md q-gutter-y-lg"},O={key:1,class:"q-my-md text-grey"},F={__name:"index",setup(e){const t=(0,l.qj)({hasSubtitle:null,search:""}),{movies:a}=(0,s.yX)(),d=(0,i.Fl)((()=>{let e=a.value;return!0===t.hasSubtitle&&(e=a.value.filter((e=>e.sub_f_path_list.length>0))),!1===t.hasSubtitle&&(e=a.value.filter((e=>0===e.sub_f_path_list.length))),""!==t.search&&(e=e.filter((e=>e.name.toLowerCase().includes(t.search.toLowerCase())))),e}));return(e,s)=>{const _=(0,i.up)("q-space"),r=(0,i.up)("q-icon"),p=(0,i.up)("q-input"),u=(0,i.up)("q-separator"),c=(0,i.up)("q-intersection"),h=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(h,{class:"q-pa-lg movie-index"},{default:(0,i.w5)((()=>[(0,i._)("div",M,[(0,i.Wm)((0,l.SU)(n.Z)),(0,i.Wm)((0,l.SU)(o.Z)),(0,i.Wm)(_),(0,i.Wm)(p,{modelValue:t.search,"onUpdate:modelValue":s[0]||(s[0]=e=>t.search=e),outlined:"",dense:"",label:"输入关键字搜索"},{append:(0,i.w5)((()=>[(0,i.Wm)(r,{name:"search"})])),_:1},8,["modelValue"])]),(0,i.Wm)(u,{class:"q-my-md"}),(0,l.SU)(a).length?((0,i.wg)(),(0,i.iD)("div",L,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)((0,l.SU)(d),(e=>((0,i.wg)(),(0,i.j4)(c,{once:"",key:e.video_f_path,style:{height:"280px"}},{default:(0,i.w5)((()=>[(0,i.Wm)((0,l.SU)(D),{data:e,width:"180px","cover-height":"220px"},null,8,["data"])])),_:2},1024)))),128))])):((0,i.wg)(),(0,i.iD)("div",O,'当前没有可用视频，点击"更新缓存"按钮可重建缓存'))])),_:1})}}};var V=a(4379),Y=a(4842),G=a(4554),K=a(5869),T=a(8218);const B=F,X=B;H()(F,"components",{QPage:V.Z,QSpace:z.Z,QInput:Y.Z,QIcon:G.Z,QSeparator:K.Z,QIntersection:T.Z})}}]);